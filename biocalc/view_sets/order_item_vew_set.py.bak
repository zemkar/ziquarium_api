

from rest_framework import viewsets, generics, pagination, status
from django.shortcuts import get_object_or_404

from biocalc.models import OrderItem, Order
from biocalc.serializers import OrderItemSerializer
from rest_framework.permissions import (
    IsAuthenticated, 
    AllowAny, 
    IsAuthenticatedOrReadOnly,
    IsAdminUser,
    )


class OrderItemViewSet(viewsets.ModelViewSet):  #TODO
    """
    Items in orders
    """
    queryset = OrderItem.objects.all()
    permission_classes = (IsAuthenticated,) #(AllowAny,)
    serializer_class = OrderItemSerializer

    
    def get_queryset(self):
        res = super().get_queryset()
        order_id = self.kwargs.get('order_id')
        return res.filter(id=order_id)

    def perform_create(self, serializer):
        order = get_object_or_404(Order, id=self.kwargs.get('order_id'))
        serializer.save(order=order)
